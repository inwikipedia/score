<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <title>Number and Date Format | SpreadJS 13</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="template/packages/jquery/script/default/jquery-1.11.3.min.js" type="text/javascript" id="mshs_support_script"></script>
    <script src="template/packages/jquery-ui/script/default/jquery-ui-1.11.4.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="template/packages/jquery-ui/css/default/jquery-ui-1.11.4.css"></link>
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n312","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <link rel="stylesheet" type="text/css" href="template/packages/light/css/dynamic-toc.css"></link>
    <meta name="Description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <link rel="stylesheet" type="text/css" href="template/packages/plugins-topics/css/default/jquery-plugins.css"></link>
    <link rel="stylesheet" type="text/css" href="template/packages/core-topics/css/topics.css"  data-mshv2-stylesheet="/template/packages/core-topics/topics.mshv2.css" data-mshv1-stylesheet="/template/packages/core-topics/topics.mshv1.css" data-responsive-mobile="template/packages/core-topics/topics.mobile.css" data-responsive-tablet="template/packages/core-topics/topics.tablet.css"></link>
    <script src="template/packages/plugins-topics/script/default/jquery-plugins.min.js" type="text/javascript"></script>
    <script src="template/packages/core-topics/script/topics.min.js" type="text/javascript"></script>
    
    <meta name="Microsoft.Help.Id" content="4678f0a8-7d7f-4743-b2a8-dc7e75f5b2f9"/>
    <meta name="Microsoft.Help.TocParent" content="edc33bc6-5882-415f-89f2-158ee31d8259"/>
    <meta name="Microsoft.Help.TocOrder" content="3"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" type="text/css" href="template/packages/core-web/css/SP.css">
<link rel="stylesheet" type="text/css" href="template/packages/core-web/css/customstyles_light.css">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs";
}
</script>
<script src="template/packages/core-web/script/topNavigation.js"></script>
<script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-WT462SJ"></script>
<script src="template/packages/custom.js"></script>
<script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime()
                , event: 'gtm.js'​
            });
            var f = d.getElementsByTagName(s)[0]
                , j = d.createElement(s)
                , dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WT462SJ');
    </script>

</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

    <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 13</div>
            <div class="i-search-container">
                <form action="websearch.html">
                <input id="i-search" name="query"/>
                <input type="submit" id="i-search-button" value=""/>
                </form>
            </div>
            <a id="i-index-button" href="webindex.html"></a>
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="overview.html">SpreadJS Documentation</a>
 / <a href="devguide.html">Developer's Guide</a>
 / <a href="features.html">Features</a>
 / <a href="managedata.html">Manage Data</a>
 / <a href="cellformat.html">Cell Format</a>
 / Number and Date Format</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Number and Date Format</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>While working with SpreadJS, users can choose to display&nbsp;numbers and dates like Excel for the two CellTypes - <strong>Text</strong> and <strong>ComboBox</strong>. The data in the cells&nbsp;is displayed differently based on the width of the columns.</p>

<p>This feature is particularly useful when users need to deal with spreadsheets containing hundreds or thousands of columns with different widths. The data is displayed dynamically according to the space available in the column.<br /></p>

<h3>Example&nbsp;</h3>

<p>For instance - If a user types "123456.654321 in a cell, the data in the cell will be displayed differently depending upon the&nbsp;column width as shown in the image below -<br />
123456.654321 -&gt; 123456.65432 -&gt; 123456.6543 -&gt; 123456.654 -&gt; 123456.65 -&gt; 123456.7 -&gt; 123457 -&gt; 1E+05 -&gt; ####<br /></p>

<p><img border="0" alt="Number format" src="images/number-display.png" /><br /></p>

<p>For displaying numbers, the following rules are applied :</p>

<ul>
    <li>When the width of the column is not sufficient to display the integer part, the scientific notation will be used. [For example - refer to the cell B1 in the above image].</li>

    <li>When the column width is such that it can include the integer part but the decimal part cannot be placed; the decimal will be rounded up [For example - refer to the cell C1 in the above image].</li>

    <li>When the shortest scientific notation is not enough [For example - refer to the cell C1 in the above image], the number will be displayed as "####" where the length of "#" depends on the column width.</li>
</ul>

<p>For displaying dates, the following rule is applied :</p>

<ul>
    <li>When the text length of the date is bigger then the column width, the cell will be displayed as "######" where the length of "#" depends on the column width.</li>
</ul>

<p><img border="0" alt="Date format" src="images/date-display1.png" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img border="0" alt="" src="images/date-display2.png" /></p>

<h3>Using Code</h3>

<p>Refer to the following example code in order to display dates and numbers according to the column width.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// Displaying Numbers
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">"ss"</span>));
<span style="COLOR: #0000ff">var</span> sheet = spread.getActiveSheet();
sheet.suspendPaint();
<span style="COLOR: #0000ff">var</span> width = [35, 45, 54, 66, 71, 80, 88, 95, 114];
<span style="COLOR: #0000ff">for</span> (<span style="COLOR: #0000ff">var</span> c = 0; c &lt; 9; c++)
{
sheet.setValue(0, c, 123456.654321);
sheet.setColumnWidth(c, width[c]);
}
sheet.resumePaint();
<span style="COLOR: #008000">// Displaying Dates
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">"ss"</span>));
<span style="COLOR: #0000ff">var</span> sheet = spread.getActiveSheet();
sheet.suspendPaint();
<span style="COLOR: #0000ff">var</span> date = <span style="COLOR: #0000ff">new</span> Date(2018, 9, 7);
sheet.setValue(0, 0, date);
sheet.setFormatter(0, 0, <span style="COLOR: #800000">'yyyy-mm-dd'</span>);
sheet.setColumnWidth(0, 80);
sheet.resumePaint();
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div><br />

<div class="i-box i-box-note">
    <p><strong>Note:</strong>&nbsp; The following limitations should&nbsp;be kept in mind while formatting dates and numbers in SpreadJS&nbsp;-</p>

    <ul>
        <li>Setting the <strong>TextIndent</strong> property will impact the&nbsp;number and date format&nbsp;in the cells. For example - when the column width is 60 px and the text Indent is set to 40 px, then only 20 px (60 px-40 px) will be left to set the number or data. But for displaying&nbsp;"#", we will have the column width of "60 px" to set "####".</li>

        <li>When <strong>shrinkToFit</strong> property is set as Boolean true, the Number and Date Format&nbsp;will not affected.</li>

        <li>When the cell format and the cell value is a number, SpreadJS&nbsp;will not&nbsp;change the value but will only show "###"&nbsp;in case the&nbsp;length of text is bigger then the column width.</li>

        <li>Date and Number&nbsp;display will not support the cell-overflow feature.<br /></li>
    </ul>
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2020 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spread-sheets" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
