<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <title>Custom Sorting | SpreadJS 13</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="template/packages/jquery/script/default/jquery-1.11.3.min.js" type="text/javascript" id="mshs_support_script"></script>
    <script src="template/packages/jquery-ui/script/default/jquery-ui-1.11.4.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="template/packages/jquery-ui/css/default/jquery-ui-1.11.4.css"></link>
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n363","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <link rel="stylesheet" type="text/css" href="template/packages/light/css/dynamic-toc.css"></link>
    <meta name="Description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <link rel="stylesheet" type="text/css" href="template/packages/plugins-topics/css/default/jquery-plugins.css"></link>
    <link rel="stylesheet" type="text/css" href="template/packages/core-topics/css/topics.css"  data-mshv2-stylesheet="/template/packages/core-topics/topics.mshv2.css" data-mshv1-stylesheet="/template/packages/core-topics/topics.mshv1.css" data-responsive-mobile="template/packages/core-topics/topics.mobile.css" data-responsive-tablet="template/packages/core-topics/topics.tablet.css"></link>
    <script src="template/packages/plugins-topics/script/default/jquery-plugins.min.js" type="text/javascript"></script>
    <script src="template/packages/core-topics/script/topics.min.js" type="text/javascript"></script>
    
    <meta name="Microsoft.Help.Id" content="52d8abf9-8fc5-47ad-8a04-bb11d64307b8"/>
    <meta name="Microsoft.Help.TocParent" content="da8d5ee2-66da-499e-ac0f-b91757afe8e7"/>
    <meta name="Microsoft.Help.TocOrder" content="21"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" type="text/css" href="template/packages/core-web/css/SP.css">
<link rel="stylesheet" type="text/css" href="template/packages/core-web/css/customstyles_light.css">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs";
}
</script>
<script src="template/packages/core-web/script/topNavigation.js"></script>
<script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-WT462SJ"></script>
<script src="template/packages/custom.js"></script>
<script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime()
                , event: 'gtm.js'​
            });
            var f = d.getElementsByTagName(s)[0]
                , j = d.createElement(s)
                , dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WT462SJ');
    </script>

</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

    <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 13</div>
            <div class="i-search-container">
                <form action="websearch.html">
                <input id="i-search" name="query"/>
                <input type="submit" id="i-search-button" value=""/>
                </form>
            </div>
            <a id="i-index-button" href="webindex.html"></a>
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="overview.html">SpreadJS Documentation</a>
 / <a href="devguide.html">Developer's Guide</a>
 / <a href="features.html">Features</a>
 / <a href="managedata.html">Manage Data</a>
 / Custom Sorting</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Custom Sorting</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>There can be several scenarios where sorting in simple&nbsp;ascending or descending order alone&nbsp;is not enough. For example, in order to sort a list of clothes according to different sizes like XXS, XS, S, M, L, XL, XXL etc. you may need to first compare the items and then sort them. To implement this type of sorting, also known as customized sorting, SpreadJS provides&nbsp;<a href="SpreadJS~GC.Spread.Sheets.Events~RangeSorting_EV.html">Events.RangeSorting</a> and&nbsp;<strong>compareFunction</strong> in the event info.</p>

<p>The following gif depicts customized sorting performed on clothing sizes.</p>

<p><img border="0" alt="Custom sorting" src="images/custom-sorting.gif" /></p>

<h4>Using Code</h4>

<p>This example sorts a list of men's clothing according to sizes.</p>

<div class="i-filtered-content-CS" data-title="CS" data-itemid="CS">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// initializing Spread
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">'ss'</span>), { sheetCount: 1 });
<span style="COLOR: #008000">// get the activeSheet
</span><span style="COLOR: #0000ff">var</span> activeSheet = spread.getActiveSheet();
<span style="COLOR: #008000">// Set Data
</span>activeSheet.setArray(1, 1, [
    [<span style="COLOR: #800000">"Men's clothing sizes"</span>], [],
    [<span style="COLOR: #800000">"XXS"</span>, <span style="COLOR: #800000">"166–170"</span>],
    [<span style="COLOR: #800000">"XS"</span>, <span style="COLOR: #800000">"168–173"</span>],
    [<span style="COLOR: #800000">"S"</span>, <span style="COLOR: #800000">"171–176"</span>],
    [<span style="COLOR: #800000">"M"</span>, <span style="COLOR: #800000">"174–179"</span>],
    [<span style="COLOR: #800000">"L"</span>, <span style="COLOR: #800000">"177–182"</span>],
    [<span style="COLOR: #800000">"XL"</span>, <span style="COLOR: #800000">"180–184"</span>],
    [<span style="COLOR: #800000">"XXL"</span>, <span style="COLOR: #800000">"182–186"</span>],
    [<span style="COLOR: #800000">"3XL"</span>, <span style="COLOR: #800000">"184–188"</span>],
    [<span style="COLOR: #800000">"4XL"</span>, <span style="COLOR: #800000">"187–190"</span>]]);
<span style="COLOR: #008000">// Here we are sorting size of clothes from XXS size to 7XL size.
// function to compare items and sort them
</span>function compareList(obj1, obj2) {
    <span style="COLOR: #0000ff">var</span> list = [<span style="COLOR: #800000">"XXS"</span>, <span style="COLOR: #800000">"XS"</span>, <span style="COLOR: #800000">"S"</span>, <span style="COLOR: #800000">"M"</span>, <span style="COLOR: #800000">"L"</span>, <span style="COLOR: #800000">"XL"</span>, <span style="COLOR: #800000">"XXL"</span>, <span style="COLOR: #800000">"3XL"</span>, <span style="COLOR: #800000">"4XL"</span>, <span style="COLOR: #800000">"5XL"</span>, <span style="COLOR: #800000">"6XL"</span>, <span style="COLOR: #800000">"7XL"</span>];
    <span style="COLOR: #0000ff">var</span> index1 = list.indexOf(obj1), index2 = list.indexOf(obj2);
    <span style="COLOR: #0000ff">if</span> (index1 &gt; index2) {
        <span style="COLOR: #0000ff">return</span> 1;
    } <span style="COLOR: #0000ff">else</span> <span style="COLOR: #0000ff">if</span> (index1 &lt; index2) {
        <span style="COLOR: #0000ff">return</span> -1;
    } <span style="COLOR: #0000ff">else</span> {
        <span style="COLOR: #0000ff">return</span> 0;
    }
}
activeSheet.rowFilter(<span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Filter.HideRowFilter(<span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Range(3, 1, 9, 2)));
activeSheet.bind(GC.Spread.Sheets.Events.RangeSorting, function (e, info) {
    info.compareFunction = compareList;
});
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="i-box i-box-note">
    <strong>Note:</strong> In&nbsp;custom UI sorting, sorting for color (Style) is not supported.
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2020 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spread-sheets" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
